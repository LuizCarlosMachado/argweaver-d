# ARGweaver Post-Processing Scripts

These scripts are designed to automate the extraction, filtering, and relabeling of Newick trees from `.smc.gz` files generated by **ARGweaverD**.

They are particularly useful for researchers who want to extract and analyze specific **local trees** from ARGweaver’s output.\
This pipeline allows users to:

- Isolate trees corresponding to specific genomic positions.
- Remove unnecessary metadata.
- Relabel nodes with meaningful sample names.
  
## Requirements

Before running the scripts, ensure that you have:

- **Python 3** installed on your system.
- A file named **`positions.txt`**, listing the chr and genomic positions of interest (one per line). Example:

```
2       35072772
2       35385475
2       35387871
2       35387961
2       35388360
```

## How to Use

1. **Navigate to the ARGweaver output directory:**
   ```bash
   cd outputs/
   ```
2. **Ensure ************************************************`positions.txt`************************************************ is in the working directory** with the positions you want to extract.
3. **Run the post-processing scripts sequentially:**
   ```bash
   python3 filter_smc.py chr${i}_positions.txt --min_iter 1500 # (Optional: filters out trees from iterations 0 to 1499)
   bash 2.convert_smc_to_newick.sh
   python3 3.format_and_relabel.py
   ```

## Script Overview

###  `1.filter_smc.py`

- Reads positions from `positions.txt`.
- Creates the `target/` directory automatically.
- Filters `.smc.gz` files, keeping only trees within the selected regions.

###  `2.convert_smc_to_newick.sh`

- Reads `positions.txt` to determine target directories.
- Extracts tree data and removes NHX annotations.

###  `3.format_and_relabel.py`

- Extracts individual labels from the first `.smc.gz` file.
- Relabels numerical nodes in Newick files using the correct labels.

## Notes

- **Every time ARGweaverD runs, new labels are generated.**\
  The relabeling step ensures consistency by dynamically extracting labels from the `.smc.gz` files.
- **Ensure ************************************************`positions.txt`************************************************ is correct before running the scripts.**
- The `target/` directory is created automatically and will store the filtered trees.


